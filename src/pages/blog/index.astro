---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("blog")).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<BaseLayout title="Blog - Rain's Personal Website">
	<section class="container blog-section">
		<h1 class="gradient-text fade-in">Blog</h1>
		<div class="posts-grid">
			{
				posts.map((post, index) => (
					<a
						href={`/blog/${post.slug}/`}
						class="post-card glass fade-in"
						style={`animation-delay: ${index * 0.1 + 0.2}s`}
					>
						{post.data.heroImage && (
							<img
								width={720}
								height={360}
								src={post.data.heroImage}
								alt=""
							/>
						)}
						<div class="content">
							<h3 class="title">{post.data.title}</h3>
							<p class="date">
								{post.data.pubDate.toLocaleDateString("en-us", {
									year: "numeric",
									month: "short",
									day: "numeric",
								})}
							</p>
							<p class="description">{post.data.description}</p>
						</div>
					</a>
				))
			}
		</div>
	</section>
</BaseLayout>

<style>
	.blog-section {
		padding-top: var(--spacing-xl);
		padding-bottom: var(--spacing-xl);
	}

	h1 {
		font-size: 3rem;
		font-weight: 700;
		margin-bottom: var(--spacing-lg);
		text-align: center;
	}

	.gradient-text {
		background: linear-gradient(135deg, #1d1d1f 0%, #434344 100%);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
	}

	:global(.dark) .gradient-text {
		background: linear-gradient(135deg, #f5f5f7 0%, #86868b 100%);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
	}

	@keyframes fadeIn {
		from {
			opacity: 0;
			transform: translateY(20px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	.fade-in {
		opacity: 0;
		animation: fadeIn 1s ease-out forwards;
	}

	.posts-grid {
		display: grid;
		grid-template-columns: 1fr;
		gap: 2rem;
	}

	@media (min-width: 768px) {
		.posts-grid {
			grid-template-columns: repeat(2, 1fr);
		}
	}

	.post-card {
		border-radius: var(--radius-lg);
		transition:
			transform 0.2s ease,
			box-shadow 0.2s ease;
		overflow: hidden;
		display: flex;
		flex-direction: column;
	}

	.post-card:hover {
		transform: translateY(-4px);
		box-shadow: var(--shadow-md);
	}

	.post-card img {
		width: 100%;
		height: 200px;
		object-fit: cover;
	}

	.content {
		padding: var(--spacing-md);
		display: flex;
		flex-direction: column;
		flex: 1;
	}

	.title {
		font-size: 1.5rem;
		font-weight: 600;
		color: var(--color-text-main);
		margin-bottom: var(--spacing-sm);
	}

	.date {
		margin: 0;
		color: var(--color-text-secondary);
		font-size: 0.9rem;
		margin-bottom: var(--spacing-sm);
	}

	.description {
		color: var(--color-text-main);
		line-height: 1.6;
	}
</style>
